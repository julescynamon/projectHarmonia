---
// src/pages/login.astro
export const prerender = false;

import MainLayout from '../layouts/MainLayout.astro';
import AuthForm from '../components/auth/AuthForm.astro';

const session = Astro.locals.session;

if (session) {
  const returnTo = Astro.url.searchParams.get('returnTo');
  return Astro.redirect(returnTo || '/mon-compte');
}
---

<MainLayout title="Connexion" description="Connectez-vous à votre compte pour accéder à vos achats.">
  <!-- Hero Section Impact -->
  <section class="relative min-h-screen flex items-center justify-center overflow-hidden hero-section">
    <!-- Background avec image et overlay -->
    <div class="absolute inset-0">
      <img 
        src="/images/contact-hero.webp" 
        alt="Connexion La Maison Sattvaïa"
        class="w-full h-full object-cover scale-110 transform motion-safe:animate-subtle-zoom"
      />
      <div class="absolute inset-0 bg-gradient-to-r from-ebony/80 via-ebony/60 to-ebony/40"></div>
    </div>
    
    <!-- Contenu principal centré -->
    <div class="container mx-auto px-4 relative z-10 flex flex-col justify-center min-h-screen">
      <div class="max-w-5xl mx-auto text-center">
        <!-- En-tête centré -->
        <div class="motion-safe:animate-fade-in">
          <div class="inline-block mb-8">
            <span class="bg-gradient-to-r from-sage to-gold bg-clip-text text-transparent font-slogan text-xl font-semibold uppercase tracking-wider">
              Accès à votre espace
            </span>
          </div>
          
          <h1 class="font-heading text-4xl md:text-5xl lg:text-6xl mb-8 leading-tight text-white drop-shadow-[0_2px_8px_rgba(0,0,0,0.3)]" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="400">
            Bienvenue dans votre <span class="text-sage">espace personnel</span>
          </h1>
          
          <p class="font-slogan text-xl md:text-2xl mb-12 text-white/90 leading-relaxed max-w-4xl mx-auto drop-shadow-[0_2px_4px_rgba(0,0,0,0.2)] italic" data-aos="fade-up" data-aos-duration="800" data-aos-delay="600">
            "Reconnectez-vous à votre chemin de bien-être et accédez à vos accompagnements personnalisés."
          </p>
        </div>
      </div>
    </div>

    <!-- Transition brush effect -->
    <div class="absolute bottom-0 left-0 w-full z-30">
      <div class="absolute inset-0 bg-gradient-to-b from-transparent to-cream"></div>
      <svg width="100%" height="80" viewBox="0 0 1200 80" preserveAspectRatio="none" class="w-full h-auto">
        <path d="M0,80 C300,20 600,60 1200,40 L1200,80 Z" fill="#faf9f7"/>
      </svg>
    </div>
  </section>

  <!-- Formulaire de connexion -->
  <section class="py-20 md:py-32 bg-gradient-to-b from-cream to-white relative overflow-hidden">
    <!-- Éléments décoratifs -->
    <div class="absolute top-0 left-0 w-72 h-72 bg-sage/5 rounded-full blur-3xl"></div>
    <div class="absolute bottom-0 right-0 w-96 h-96 bg-gold/5 rounded-full blur-3xl"></div>
    <div class="absolute inset-0 bg-geometric-pattern opacity-3"></div>

    <div class="container mx-auto px-4 relative">
      <!-- En-tête section -->
      <div class="text-center max-w-4xl mx-auto mb-16" data-aos="fade-up" data-aos-duration="1000">
        <div class="inline-block mb-6">
          <span class="bg-gradient-to-r from-sage to-gold bg-clip-text text-transparent font-slogan text-lg font-semibold uppercase tracking-wider">
            Connexion
          </span>
        </div>
        <h2 class="font-heading text-4xl md:text-5xl lg:text-6xl text-ebony mb-8 leading-tight">
          Accédez à votre <span class="text-sage">espace</span>
        </h2>
        <p class="font-slogan text-xl text-eucalyptus leading-relaxed">
          Connectez-vous pour accéder à vos commandes et accompagnements personnalisés
        </p>
      </div>

      <!-- Formulaire centré -->
      <div class="max-w-md mx-auto" data-aos="fade-up" data-aos-offset="50" data-aos-duration="1000">
        <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 lg:p-12 shadow-xl border border-sage/10 hover:shadow-2xl transition-all duration-500">
          <AuthForm type="login" />
        </div>
      </div>
    </div>
  </section>
</MainLayout>

<style>
  @keyframes subtle-zoom {
    0% { transform: scale(1.1); }
    50% { transform: scale(1.15); }
    100% { transform: scale(1.1); }
  }

  @keyframes fade-in {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .animate-subtle-zoom {
    animation: subtle-zoom 20s infinite alternate ease-in-out;
  }

  .animate-fade-in {
    animation: fade-in 1.5s ease-out forwards;
  }

  /* Styles pour les éléments de formulaire avec effet glassmorphism */
  .backdrop-blur-sm {
    backdrop-filter: blur(10px);
  }
</style>
